---
import colorHorizontalLogo from '../../assets/logo/color-horizontal.svg';
import ContactForm from '../ui/forms/ContactForm.tsx';
import { CheckCircleIcon, HomeModernIcon, DocumentTextIcon, CalendarIcon, PhoneIcon } from '@heroicons/react/24/solid';

// Get the current locale from the URL
const pathname = Astro.url.pathname;
const currentLang = pathname.startsWith('/es') ? 'es' : 'en';

// Define services array based on language
const services = currentLang === 'es' ? [
  "Visas e Inmigración",
  "Transacciones Inmobiliarias", 
  "Asesoría Legal"
] : [
  "Visas & Immigration",
  "Real Estate Transactions",
  "Legal Advice"
];

// Define content based on language with updated copy
const content = currentLang === 'es' ? {
  mainHeading: {
    line1: "Abogados colombianos",
    line2: "bilingües",
    line3: "trabajando para ti  ",
    line4: "incansablemente"
  },
  subtitle: "Rápidos, confiables, bilingües",
  description: "Trabajamos para ti incansablemente.",
  servicesTitle: "Nuestros Servicios",
  calendlyUrl: "https://calendly.com/capital-m-law/programmed-initial-consultation",
  cta: {
    contact: "Contáctanos",
    whatsapp: "WhatsApp",
    bookConsultation: "Reservar Consulta"
  }
} : {
  mainHeading: {
    line1: "Colombian",
    line2: "bilingual attorneys",
    line3: "working for you",
    line4: "restlessly"
  },
  subtitle: "Fast, Reliable, Bilingual",
  description: "We work for you restlessly.",
  servicesTitle: "Our Services",
  calendlyUrl: "https://calendly.com/capital-m-law/programmed-initial-consultation",
  cta: {
    contact: "Write Us",
    whatsapp: "WhatsApp",
    bookConsultation: "Book Consultation"
  }
};
---

<!-- Ultra-Responsive Hero Section -->
<style>
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes serviceHover {
    0% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-4px);
    }
    100% {
      transform: translateY(0);
    }
  }
  
  .fade-in-up {
    animation: fadeInUp 0.8s ease-out forwards;
  }
  
  .service-item {
    transition: all 0.3s ease;
  }
  
  .service-item:hover {
    animation: serviceHover 0.6s ease-in-out;
  }
  
  .gradient-bg {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
  }
  
  .card-shadow {
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }
</style>

<section class="relative min-h-screen bg-white overflow-hidden">
  <!-- Main Content Container -->
  <div class="relative z-10 min-h-screen flex items-center">
    <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 xl:px-12">
      
      <!-- Mobile Layout (Stacked) -->
      <div class="lg:hidden space-y-8 py-8">
        
        <!-- Logo - Mobile -->
        <div class="flex justify-center fade-in-up">
          <img 
            src={colorHorizontalLogo.src} 
            alt="Capital M Logo" 
            class="h-10 sm:h-12 w-auto"
          />
        </div>
        
        <!-- Main Heading - Mobile Optimized -->
        <div class="text-center space-y-3 fade-in-up" style="animation-delay: 0.2s">
          <h1 class="text-2xl sm:text-3xl font-bold text-primary leading-tight">
            {content.mainHeading.line1}
            <span class="block text-secondary">{content.mainHeading.line2}</span>
            <span class="block text-primary">
              {content.mainHeading.line3}
              <span class="text-secondary underline decoration-2 decoration-secondary underline-offset-4">{content.mainHeading.line4}</span>
            </span>
          </h1>
          
          <!-- Subtitle - Mobile -->
          <p class="text-lg sm:text-xl font-semibold text-secondary">
            {content.subtitle}
          </p>
          
          <!-- Description - Mobile -->
          <p class="text-base text-gray-600 leading-relaxed">
            {content.description}
          </p>
        </div>
        
        <!-- Services List - Mobile Optimized (Cleaner Design) -->
        <div class="space-y-3 fade-in-up" style="animation-delay: 0.4s">
          {services.map((service, index) => (
            <div class="service-item group flex items-center space-x-4 p-4 bg-gray-50 rounded-xl border border-gray-200 hover:border-blue-300 hover:bg-blue-50/50 transition-all duration-300">
              <div class="w-8 h-8 sm:w-10 sm:h-10 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition-colors duration-300 flex-shrink-0">
                {index === 0 && (
                  <CheckCircleIcon className="w-4 h-4 sm:w-5 sm:h-5 text-blue-600" />
                )}
                {index === 1 && (
                  <HomeModernIcon className="w-4 h-4 sm:w-5 sm:h-5 text-blue-600" />
                )}
                                  {index === 2 && (
                    <DocumentTextIcon className="w-4 h-4 sm:w-5 sm:h-5 text-blue-600" />
                  )}
              </div>
              <span class="text-gray-900 font-medium text-sm sm:text-base">{service}</span>
            </div>
          ))}
        </div>
        
        <!-- Mobile Contact Form -->
        <div class="fade-in-up" style="animation-delay: 0.6s">
          <div class="bg-white rounded-2xl p-6 border border-gray-200 card-shadow">
            <div class="text-center space-y-4">
              <!-- Calendly Button - Mobile -->
              <a href={content.calendlyUrl} target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 text-sm font-medium transition-all duration-200 w-full">
                <CalendarIcon className="w-4 h-4 mr-2" />
                {content.cta.bookConsultation}
              </a>
              
              <!-- Mobile Contact Buttons -->
              <div class="grid grid-cols-2 gap-3 pt-4 border-t border-gray-200">
                <a href={currentLang === 'en' ? '/en/contact' : '/es/contact'} class="inline-flex items-center justify-center bg-gray-800 text-white px-4 py-3 rounded-lg hover:bg-gray-900 text-sm font-medium transition-all duration-200">
                  <PhoneIcon className="w-4 h-4 mr-2" />
                  {content.cta.contact}
                </a>
                <a href="https://wa.me/573001234567?text=Hola,%20necesito%20información%20sobre%20servicios%20legales" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 text-sm font-medium transition-all duration-200">
                  <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.86 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                  </svg>
                  {content.cta.whatsapp}
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Desktop Layout (Two Columns) -->
      <div class="hidden lg:grid lg:grid-cols-2 gap-12 xl:gap-16 items-center">
        
        <!-- Left Column - Main Content -->
        <div class="space-y-8 xl:space-y-10">
          <!-- Main Heading - Desktop Optimized -->
          <div class="space-y-6 fade-in-up">
            <h1 class="text-4xl xl:text-5xl 2xl:text-6xl font-bold text-primary leading-tight">
              {content.mainHeading.line1}
              <span class="block text-secondary">{content.mainHeading.line2}</span>
              <span class="block text-primary">
                {content.mainHeading.line3}
                <span class="text-secondary underline decoration-2 decoration-secondary underline-offset-4">{content.mainHeading.line4}</span>
              </span>
            </h1>
          </div>
          
          <!-- Subtitle and Description - Desktop -->
          <div class="space-y-4 fade-in-up" style="animation-delay: 0.2s">
            <p class="text-2xl xl:text-3xl font-semibold text-secondary">
              {content.subtitle}
            </p>            
          </div>
          
          <!-- Services List - Clean Minimalist Design -->
          <div class="space-y-6 fade-in-up" style="animation-delay: 0.4s">
            <h3 class="text-xl font-semibold text-gray-900">
              {content.servicesTitle}
            </h3>
            <div class="space-y-5">
              {services.map((service, index) => (
                <div class="flex items-center space-x-4">
                  {index === 0 && (
                    <HomeModernIcon className="w-6 h-6 text-secondary flex-shrink-0" />
                  )}
                  {index === 1 && (
                    <DocumentTextIcon className="w-6 h-6 text-secondary flex-shrink-0" />
                  )}
                  {index === 2 && (
                    <DocumentTextIcon className="w-6 h-6 text-secondary flex-shrink-0" />
                  )}
                  <span class="text-gray-700 font-medium text-lg">{service}</span>
                </div>
              ))}
            </div>
          </div>
        </div>
        
        <!-- Right Column - Simple Action Buttons with Modals -->
        <div class="relative fade-in-up" style="animation-delay: 0.6s">
          <div class="relative">
            <!-- Main Card -->
            <div class="bg-white rounded-2xl p-6 xl:p-8 border border-gray-200 card-shadow">
              <div class="text-center space-y-8">
                <!-- Logo Area -->
                <div class="flex items-center justify-center mx-auto">
                  <div class="transition-all duration-600 hover:scale-110">
                    <img 
                      src={colorHorizontalLogo.src} 
                      alt="Capital M Logo" 
                      class="h-14 xl:h-16 w-auto"
                    />
                  </div>
                </div>
                
                <!-- Main Action Buttons -->
                <div class="grid grid-cols-2 gap-3">
                  <!-- Book Consultation Button -->
                  <button 
                    onclick="openCalendlyModal()"
                    class="bg-primary/90 text-white font-medium py-3 px-4 rounded-lg hover:bg-primary transition-all duration-200 group text-sm"
                  >
                    <CalendarIcon className="w-4 h-4 mr-2 inline-block group-hover:scale-105 transition-transform duration-200" />
                    {content.cta.bookConsultation}
                  </button>
                  
                  <!-- Contact Form Button -->
                  <button 
                    onclick="openContactModal()"
                    class="bg-secondary/90 text-white font-medium py-3 px-4 rounded-lg hover:bg-secondary transition-all duration-200 group text-sm"
                  >
                    <PhoneIcon className="w-4 h-4 mr-2 inline-block group-hover:scale-105 transition-transform duration-200" />
                    {content.cta.contact}
                  </button>
                </div>
                
                <!-- Divider -->
                <div class="relative">
                  <div class="absolute inset-0 flex items-center">
                    <div class="w-full border-t border-gray-200"></div>
                  </div>
                  <div class="relative flex justify-center text-sm">
                    <span class="px-4 bg-white text-gray-500">
                      {currentLang === 'es' ? 'O contáctanos directamente' : 'Or contact us directly'}
                    </span>
                  </div>
                </div>
                
                <!-- Direct Contact Buttons -->
                <div class="grid grid-cols-2 gap-3">
                  <a href="mailto:info@capitaleme.com" class="inline-flex items-center justify-center bg-gray-100 text-gray-700 px-4 py-3 rounded-lg hover:bg-gray-200 text-sm font-medium transition-all duration-200 group">
                    <svg class="w-4 h-4 mr-2 group-hover:scale-105 transition-transform duration-200" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                    </svg>
                    Email
                  </a>
                  <a href="https://wa.me/573001234567?text=Hola,%20necesito%20información%20sobre%20servicios%20legales" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center bg-green-100 text-green-700 px-4 py-3 rounded-lg hover:bg-green-200 text-sm font-medium transition-all duration-200 group">
                    <svg class="w-4 h-4 mr-2 group-hover:scale-105 transition-transform duration-200" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.87 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.86 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                    </svg>
                    WhatsApp
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script is:inline>
  function openCalendlyModal() {
    const modal = document.createElement('div');
    modal.id = 'calendly-modal';
    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
    
    const currentLang = window.location.pathname.includes('/es') ? 'es' : 'en';
    const title = currentLang === 'es' ? 'Reserva tu consulta' : 'Book your consultation';
    const subtitle = currentLang === 'es' ? 'Elige el horario que mejor te convenga' : 'Choose the time that works best for you';
    const closeText = currentLang === 'es' ? 'Cerrar' : 'Close';
    
    modal.innerHTML = `
      <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6 border-b border-gray-100">
          <div class="flex justify-between items-center">
            <div class="text-center flex-1">
              <h3 class="text-xl font-semibold text-gray-900">${title}</h3>
              <p class="text-gray-600 text-sm mt-1">${subtitle}</p>
            </div>
            <button onclick="closeModal('calendly-modal')" class="text-gray-400 hover:text-gray-600 transition-colors duration-200">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="p-6">
          <div class="calendly-inline-widget" data-url="https://calendly.com/capital-m-law/programmed-initial-consultation" style="min-width:320px;height:600px;"></div>
        </div>
        <div class="p-6 border-t border-gray-100">
          <button onclick="closeModal('calendly-modal')" class="w-full bg-primary text-white font-medium py-3 px-6 rounded-lg hover:bg-primary/90 transition-all duration-200">
            ${closeText}
          </button>
        </div>
      </div>
    `;
    
    document.body.appendChild(modal);
    
    // Load Calendly script
    const script = document.createElement('script');
    script.src = 'https://assets.calendly.com/assets/external/widget.js';
    script.async = true;
    document.head.appendChild(script);
  }

  function openContactModal() {
    const modal = document.createElement('div');
    modal.id = 'contact-modal';
    modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
    
    const currentLang = window.location.pathname.includes('/es') ? 'es' : 'en';
    const title = currentLang === 'es' ? 'Envíanos un mensaje' : 'Send us a message';
    const subtitle = currentLang === 'es' ? 'Te responderemos en menos de 24 horas' : 'We\'ll get back to you within 24 hours';
    const closeText = currentLang === 'es' ? 'Cerrar' : 'Close';
    
    modal.innerHTML = `
      <div class="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6 border-b border-gray-100">
          <div class="flex justify-between items-center">
            <div class="text-center flex-1">
              <h3 class="text-xl font-semibold text-gray-900">${title}</h3>
              <p class="text-gray-600 text-sm mt-1">${subtitle}</p>
            </div>
            <button onclick="closeModal('contact-modal')" class="text-gray-400 hover:text-gray-600 transition-colors duration-200">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="p-6">
          <div id="contact-form-container">
            <!-- Contact form will be loaded here -->
            <div class="text-center py-8">
              <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"></div>
              <p class="text-gray-500 mt-2">Loading form...</p>
            </div>
          </div>
        </div>
        <div class="p-6 border-t border-gray-100 hidden">
          <button onclick="closeModal('contact-modal')" class="w-full bg-secondary text-white font-medium py-3 px-6 rounded-lg hover:bg-secondary/90 transition-all duration-200">
            ${closeText}
          </button>
        </div>
      </div>
    `;
    
    document.body.appendChild(modal);
    
    // Load the contact form component
    loadContactForm(currentLang);
  }

  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.remove();
    }
  }

  function loadContactForm(lang) {
    const container = document.getElementById('contact-form-container');
    if (container) {
      // Create a simple contact form directly in the modal
      container.innerHTML = `
        <form class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
              ${lang === 'es' ? 'Nombre completo' : 'Full Name'}
            </label>
            <input type="text" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
              ${lang === 'es' ? 'Email' : 'Email'}
            </label>
            <input type="email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
              ${lang === 'es' ? 'Teléfono' : 'Phone'}
            </label>
            <input type="tel" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
              ${lang === 'es' ? 'Mensaje' : 'Message'}
            </label>
            <textarea rows="4" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent resize-none"></textarea>
          </div>
          
          <button type="submit" class="w-full bg-primary text-white font-medium py-3 px-6 rounded-lg hover:bg-primary/90 transition-all duration-200">
            ${lang === 'es' ? 'Enviar mensaje' : 'Send Message'}
          </button>
        </form>
      `;
      
      // Add form submission handler
      const form = container.querySelector('form');
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        // Here you would normally send the form data
        alert(lang === 'es' ? '¡Mensaje enviado! Te contactaremos pronto.' : 'Message sent! We\'ll contact you soon.');
        closeModal('contact-modal');
      });
    }
  }

  // Close modal when clicking outside
  document.addEventListener('click', function(event) {
    if (event.target.classList.contains('fixed') && event.target.classList.contains('bg-black')) {
      event.target.remove();
    }
  });
</script>
