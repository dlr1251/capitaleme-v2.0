---
import Layout from '../../layouts/Layout.astro';
import HomePageHero from '../../components/shared/HomePageHero.astro';
import AboutPageSection from '../../components/about/AboutPageSection.astro';
import HowWeWork from '../../components/home/es/HowWeWork.astro';
import HomeVisaAssistanceSection from '../../components/visas/HomeVisaAssistanceSection.tsx';
import HomeRealEstateSection from '../../components/real-estate/es/HomeRealEstateSection.tsx';
import HomePageCLKR from '../../components/clkr/HomePageCLKR.tsx';
import BlogPageLatest from '../../components/blog/BlogPageLatest.astro';
import { getAllContentData } from '../../server/lib/contentData.js';

const lang = 'es';
const menuData = await getAllContentData(lang);

const allVisas = menuData?.allVisas || [];
const guides = menuData?.allGuides || [];
const popularVisas = allVisas.filter((v: any) => v.isPopular);
const featuredProperty = null; // No featuredProperty in new server data

---
<Layout title="Capital M Law - Home" lang={lang} menuData={menuData}>
	<main class="">        
        <HomePageHero currentLang="es"/>
        <AboutPageSection/>
        <HomeVisaAssistanceSection visas={allVisas} guides={guides} lang="es" client:load />
        <HomeRealEstateSection featuredProperty={featuredProperty} features={[]} lang="es" client:load />
        <HomePageCLKR lang="es" clkrServices={menuData?.clkrServices || []} client:load />
    		<!-- <CalendlyInline /> -->
        <HowWeWork lang="es"/>
		    <BlogPageLatest/>
	</main>
</Layout>
